// Generated by Haxe 4.3.0+731dcd7
#include <hxcpp.h>

#ifndef INCLUDED_Global
#include <Global.h>
#endif
#ifndef INCLUDED_Std
#include <Std.h>
#endif
#ifndef INCLUDED_account_Account
#include <account/Account.h>
#endif
#ifndef INCLUDED_account_services_BuySkinTask
#include <account/services/BuySkinTask.h>
#endif
#ifndef INCLUDED_appengine_CompletionData
#include <appengine/CompletionData.h>
#endif
#ifndef INCLUDED_appengine_RequestHandler
#include <appengine/RequestHandler.h>
#endif
#ifndef INCLUDED_classes_model_CharacterSkin
#include <classes/model/CharacterSkin.h>
#endif
#ifndef INCLUDED_classes_model_CharacterSkinState
#include <classes/model/CharacterSkinState.h>
#endif
#ifndef INCLUDED_core_Layers
#include <core/Layers.h>
#endif
#ifndef INCLUDED_core_PlayerModel
#include <core/PlayerModel.h>
#endif
#ifndef INCLUDED_haxe_http_HttpBase
#include <haxe/http/HttpBase.h>
#endif
#ifndef INCLUDED_lib_tasks_Task
#include <lib/tasks/Task.h>
#endif
#ifndef INCLUDED_openfl_display_DisplayObject
#include <openfl/display/DisplayObject.h>
#endif
#ifndef INCLUDED_openfl_display_DisplayObjectContainer
#include <openfl/display/DisplayObjectContainer.h>
#endif
#ifndef INCLUDED_openfl_display_IBitmapDrawable
#include <openfl/display/IBitmapDrawable.h>
#endif
#ifndef INCLUDED_openfl_display_InteractiveObject
#include <openfl/display/InteractiveObject.h>
#endif
#ifndef INCLUDED_openfl_display_Sprite
#include <openfl/display/Sprite.h>
#endif
#ifndef INCLUDED_openfl_events_EventDispatcher
#include <openfl/events/EventDispatcher.h>
#endif
#ifndef INCLUDED_openfl_events_IEventDispatcher
#include <openfl/events/IEventDispatcher.h>
#endif
#ifndef INCLUDED_sys_Http
#include <sys/Http.h>
#endif
#ifndef INCLUDED_ui_dialogs_Dialog
#include <ui/dialogs/Dialog.h>
#endif
#ifndef INCLUDED_ui_dialogs_DialogsView
#include <ui/dialogs/DialogsView.h>
#endif
#ifndef INCLUDED_ui_dialogs_ErrorDialog
#include <ui/dialogs/ErrorDialog.h>
#endif
#ifndef INCLUDED_util_Signal
#include <util/Signal.h>
#endif

HX_DEFINE_STACK_FRAME(_hx_pos_e51bfdbfcc696603_12_new,"account.services.BuySkinTask","new",0x66236eab,"account.services.BuySkinTask.new","account/services/BuySkinTask.hx",12,0xd49ecf05)
HX_LOCAL_STACK_FRAME(_hx_pos_e51bfdbfcc696603_15_startTask,"account.services.BuySkinTask","startTask",0x9f0e2152,"account.services.BuySkinTask.startTask","account/services/BuySkinTask.hx",15,0xd49ecf05)
HX_LOCAL_STACK_FRAME(_hx_pos_e51bfdbfcc696603_25_onComplete,"account.services.BuySkinTask","onComplete",0xc3c6660d,"account.services.BuySkinTask.onComplete","account/services/BuySkinTask.hx",25,0xd49ecf05)
HX_LOCAL_STACK_FRAME(_hx_pos_e51bfdbfcc696603_34_completePurchase,"account.services.BuySkinTask","completePurchase",0x9abfa06f,"account.services.BuySkinTask.completePurchase","account/services/BuySkinTask.hx",34,0xd49ecf05)
HX_LOCAL_STACK_FRAME(_hx_pos_e51bfdbfcc696603_39_abandonPurchase,"account.services.BuySkinTask","abandonPurchase",0x5b682ae1,"account.services.BuySkinTask.abandonPurchase","account/services/BuySkinTask.hx",39,0xd49ecf05)
namespace account{
namespace services{

void BuySkinTask_obj::__construct(){
            	HX_STACKFRAME(&_hx_pos_e51bfdbfcc696603_12_new)
HXDLIN(  12)		super::__construct();
            	}

Dynamic BuySkinTask_obj::__CreateEmpty() { return new BuySkinTask_obj; }

void *BuySkinTask_obj::_hx_vtable = 0;

Dynamic BuySkinTask_obj::__Create(::hx::DynamicArray inArgs)
{
	::hx::ObjectPtr< BuySkinTask_obj > _hx_result = new BuySkinTask_obj();
	_hx_result->__construct();
	return _hx_result;
}

bool BuySkinTask_obj::_hx_isInstanceOf(int inClassId) {
	if (inClassId<=(int)0x51358a7d) {
		return inClassId==(int)0x00000001 || inClassId==(int)0x51358a7d;
	} else {
		return inClassId==(int)0x7e99215e;
	}
}

void BuySkinTask_obj::startTask(){
            	HX_STACKFRAME(&_hx_pos_e51bfdbfcc696603_15_startTask)
HXLINE(  16)		::account::services::BuySkinTask_obj::skin->setState(::classes::model::CharacterSkinState_obj::PURCHASING);
HXLINE(  17)		::Global_obj::playerModel->addGems(-(::account::services::BuySkinTask_obj::skin->cost));
HXLINE(  18)		::appengine::RequestHandler_obj::http->setParameter(HX_("email",1c,cf,ce,6f),::account::Account_obj::email);
HXLINE(  19)		::appengine::RequestHandler_obj::http->setParameter(HX_("password",1b,23,d0,48),::account::Account_obj::password);
HXLINE(  20)		{
HXLINE(  20)			::String value = ::Std_obj::string(::account::services::BuySkinTask_obj::skin->id);
HXDLIN(  20)			::appengine::RequestHandler_obj::http->setParameter(HX_("skinType",d7,b7,90,9c),value);
            		}
HXLINE(  21)		::appengine::RequestHandler_obj::complete->once(this->onComplete_dyn());
HXLINE(  22)		::appengine::RequestHandler_obj::sendRequest(HX_("account/purchaseSkin",c0,90,4e,ec));
            	}


void BuySkinTask_obj::onComplete( ::appengine::CompletionData compData){
            	HX_STACKFRAME(&_hx_pos_e51bfdbfcc696603_25_onComplete)
HXLINE(  26)		if (compData->success) {
HXLINE(  27)			this->completePurchase();
            		}
            		else {
HXLINE(  29)			this->abandonPurchase(compData->result);
            		}
HXLINE(  31)		this->completeTask(compData->success,compData->result);
            	}


HX_DEFINE_DYNAMIC_FUNC1(BuySkinTask_obj,onComplete,(void))

void BuySkinTask_obj::completePurchase(){
            	HX_STACKFRAME(&_hx_pos_e51bfdbfcc696603_34_completePurchase)
HXLINE(  35)		::account::services::BuySkinTask_obj::skin->setState(::classes::model::CharacterSkinState_obj::OWNED);
HXLINE(  36)		::account::services::BuySkinTask_obj::skin->setIsSelected(true);
            	}


HX_DEFINE_DYNAMIC_FUNC0(BuySkinTask_obj,completePurchase,(void))

void BuySkinTask_obj::abandonPurchase(::String problem){
            	HX_GC_STACKFRAME(&_hx_pos_e51bfdbfcc696603_39_abandonPurchase)
HXLINE(  40)		 ::ui::dialogs::DialogsView _hx_tmp = ::Global_obj::layers->dialogs;
HXDLIN(  40)		_hx_tmp->openDialog( ::ui::dialogs::ErrorDialog_obj::__alloc( HX_CTX ,problem));
HXLINE(  41)		::account::services::BuySkinTask_obj::skin->setState(::classes::model::CharacterSkinState_obj::PURCHASABLE);
HXLINE(  42)		::Global_obj::playerModel->addGems(::account::services::BuySkinTask_obj::skin->cost);
            	}


HX_DEFINE_DYNAMIC_FUNC1(BuySkinTask_obj,abandonPurchase,(void))

 ::classes::model::CharacterSkin BuySkinTask_obj::skin;


::hx::ObjectPtr< BuySkinTask_obj > BuySkinTask_obj::__new() {
	::hx::ObjectPtr< BuySkinTask_obj > __this = new BuySkinTask_obj();
	__this->__construct();
	return __this;
}

::hx::ObjectPtr< BuySkinTask_obj > BuySkinTask_obj::__alloc(::hx::Ctx *_hx_ctx) {
	BuySkinTask_obj *__this = (BuySkinTask_obj*)(::hx::Ctx::alloc(_hx_ctx, sizeof(BuySkinTask_obj), true, "account.services.BuySkinTask"));
	*(void **)__this = BuySkinTask_obj::_hx_vtable;
	__this->__construct();
	return __this;
}

BuySkinTask_obj::BuySkinTask_obj()
{
}

::hx::Val BuySkinTask_obj::__Field(const ::String &inName,::hx::PropertyAccess inCallProp)
{
	switch(inName.length) {
	case 9:
		if (HX_FIELD_EQ(inName,"startTask") ) { return ::hx::Val( startTask_dyn() ); }
		break;
	case 10:
		if (HX_FIELD_EQ(inName,"onComplete") ) { return ::hx::Val( onComplete_dyn() ); }
		break;
	case 15:
		if (HX_FIELD_EQ(inName,"abandonPurchase") ) { return ::hx::Val( abandonPurchase_dyn() ); }
		break;
	case 16:
		if (HX_FIELD_EQ(inName,"completePurchase") ) { return ::hx::Val( completePurchase_dyn() ); }
	}
	return super::__Field(inName,inCallProp);
}

bool BuySkinTask_obj::__GetStatic(const ::String &inName, Dynamic &outValue, ::hx::PropertyAccess inCallProp)
{
	switch(inName.length) {
	case 4:
		if (HX_FIELD_EQ(inName,"skin") ) { outValue = ( skin ); return true; }
	}
	return false;
}

bool BuySkinTask_obj::__SetStatic(const ::String &inName,Dynamic &ioValue,::hx::PropertyAccess inCallProp)
{
	switch(inName.length) {
	case 4:
		if (HX_FIELD_EQ(inName,"skin") ) { skin=ioValue.Cast<  ::classes::model::CharacterSkin >(); return true; }
	}
	return false;
}

#ifdef HXCPP_SCRIPTABLE
static ::hx::StorageInfo *BuySkinTask_obj_sMemberStorageInfo = 0;
static ::hx::StaticInfo BuySkinTask_obj_sStaticStorageInfo[] = {
	{::hx::fsObject /*  ::classes::model::CharacterSkin */ ,(void *) &BuySkinTask_obj::skin,HX_("skin",7d,16,55,4c)},
	{ ::hx::fsUnknown, 0, null()}
};
#endif

static ::String BuySkinTask_obj_sMemberFields[] = {
	HX_("startTask",c7,38,ea,05),
	HX_("onComplete",f8,d4,7e,5d),
	HX_("completePurchase",9a,91,b2,b3),
	HX_("abandonPurchase",16,c8,3e,be),
	::String(null()) };

static void BuySkinTask_obj_sMarkStatics(HX_MARK_PARAMS) {
	HX_MARK_MEMBER_NAME(BuySkinTask_obj::skin,"skin");
};

#ifdef HXCPP_VISIT_ALLOCS
static void BuySkinTask_obj_sVisitStatics(HX_VISIT_PARAMS) {
	HX_VISIT_MEMBER_NAME(BuySkinTask_obj::skin,"skin");
};

#endif

::hx::Class BuySkinTask_obj::__mClass;

static ::String BuySkinTask_obj_sStaticFields[] = {
	HX_("skin",7d,16,55,4c),
	::String(null())
};

void BuySkinTask_obj::__register()
{
	BuySkinTask_obj _hx_dummy;
	BuySkinTask_obj::_hx_vtable = *(void **)&_hx_dummy;
	::hx::Static(__mClass) = new ::hx::Class_obj();
	__mClass->mName = HX_("account.services.BuySkinTask",39,3d,2e,d5);
	__mClass->mSuper = &super::__SGetClass();
	__mClass->mConstructEmpty = &__CreateEmpty;
	__mClass->mConstructArgs = &__Create;
	__mClass->mGetStaticField = &BuySkinTask_obj::__GetStatic;
	__mClass->mSetStaticField = &BuySkinTask_obj::__SetStatic;
	__mClass->mMarkFunc = BuySkinTask_obj_sMarkStatics;
	__mClass->mStatics = ::hx::Class_obj::dupFunctions(BuySkinTask_obj_sStaticFields);
	__mClass->mMembers = ::hx::Class_obj::dupFunctions(BuySkinTask_obj_sMemberFields);
	__mClass->mCanCast = ::hx::TCanCast< BuySkinTask_obj >;
#ifdef HXCPP_VISIT_ALLOCS
	__mClass->mVisitFunc = BuySkinTask_obj_sVisitStatics;
#endif
#ifdef HXCPP_SCRIPTABLE
	__mClass->mMemberStorageInfo = BuySkinTask_obj_sMemberStorageInfo;
#endif
#ifdef HXCPP_SCRIPTABLE
	__mClass->mStaticStorageInfo = BuySkinTask_obj_sStaticStorageInfo;
#endif
	::hx::_hx_RegisterClass(__mClass->mName, __mClass);
}

} // end namespace account
} // end namespace services
